#include <vector>
#include <cmath>
#include <cstring>
#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include <nlopt.hpp>
#include <iomanip>
#include <sys/time.h>
#include <gsl/gsl_sf_lambert.h>


#include "bounds.h"

double M2G (double m) {
return (100*1e5*1e9*m)/1.973;
}

double Gvee(double U, double ms){
	double PI=3.14159;
	double GF=0.00001166;
	return U*U*pow(ms,5)*GF*GF/(96*PI*PI*PI);
}

double GammaNeeded2DecayBefore(double mn, double en, double L, double L0){

	double U=1;

	double BR=0.126469;

	double Gtot= Gvee(U,mn);
	double pn = sqrt(en*en-mn*mn);
	double B = exp(-Gtot*mn*M2G(L)/pn)*(1-exp(-mn*M2G(L0)*Gtot/pn))*BR;
	double A = L0/L;
	
	return -pn/(mn*M2G(L))*gsl_sf_lambert_Wm1(-B/A);
}

bool bound_is_legit_tau(double up, double ud, double chi, double ms, double mzp ){

	bool ans = false;
	
	if( 	
		(up*ud*chi <= pow(mzp/91.0,2)*pow(boundPS191u(ms),2) || (pow(up,2)+pow(ud,2))*chi*chi >= GammaNeeded2DecayBefore(ms,2, 128, 12)/Gvee(1,ms)*pow(mzp/91.0,4))
		 && 
		(ud*ud*chi <= pow(mzp/91.0,2)*pow(boundNOMADt(ms),2) || (pow(up,2)+pow(ud,2))*chi*chi >= GammaNeeded2DecayBefore(ms,18, 825, 7)/Gvee(1,ms)*pow(mzp/91.0,4)) 
		 && 	
		(chi <= sqrt(boundBABARzp(mzp)))
	){
	ans=true;
	}

	return ans;
}




double boundBASEu(double ms){ //Its on Ut not Ut^2
	std::vector<double > list ={0.109973,0.0348589,0.00672603,0.00589574,0.00696251,0.00651938,0.00605065,0.00558191,0.00511317,0.00464443,0.00427864,0.00402427,0.0037699,0.00351553,0.00326116,0.00300679,0.0033171,0.00472731,0.00374499,0.00387556,0.00451693,0.00507312,0.00455313,0.00350685,0.00303525,0.00322463,0.00369838,0.00325498,0.0037642,0.00576819,0.00998774,0.0102558,0.0113387,0.0463233,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.238917,0.022867,0.00932017,0.00867425,0.00818044,0.00783267,0.00748401,0.00713159,0.00677916,0.0063953,0.00600682,0.00565855,0.00531384,0.00500809,0.00470536,0.00453014,0.00435492,0.00422313,0.00411052,0.00399794,0.00388949,0.00378104,0.00367384,0.00356924,0.00346463,0.00336542,0.00326928,0.00317314,0.00308436,0.00299596,0.0029092,0.00282696,0.00274472,0.002675,0.00261429,0.00255359,0.00251592,0.00248093,0.00244647,0.00241397,0.00238146,0.00234957,0.00231823,0.00228688,0.00225523,0.00222352,0.00219204,0.00216187,0.0021317,0.00210157,0.00207148,0.00204139,0.00201194,0.00198267,0.00195354,0.00192572,0.0018979,0.00187051,0.00184375,0.001817,0.00179055,0.00176423,0.00173796,0.00171294,0.00168793,0.00166336,0.00163958,0.0016158,0.00159264,0.00156977,0.0015469,0.00152638,0.00150589,0.00148811,0.00147666,0.00146521,0.0015519,0.00164778,0.00144685,0.00142308,0.00141279,0.00140261,0.00139275,0.0013829,0.00137302,0.00136312,0.00135322,0.00134349,0.00133378,0.00132415,0.00131485,0.00130555,0.00129623,0.00128689,0.00127754,0.00126835,0.00125919,0.00125008,0.0012413,0.00123252,0.00122373,0.00121492,0.0012061,0.00119742,0.00118877,0.00118021,0.00117271,0.00116521,0.00115753,0.00114958,0.00114163,0.00113445,0.00112759,0.00112073,0.00111361,0.00110649,0.00109935,0.00109217,0.00108499,0.00107789,0.00107083,0.00106377,0.00105701,0.00105025,0.00104362,0.00103733,0.00103104,0.0010243,0.00101725,0.00101021,0.00100389,0.000997642,0.000991383,0.000985076,0.000978769,0.00097252,0.000966321,0.000960122,0.000953878,0.000947626,0.000941572,0.000936524,0.000931476,0.000927577,0.000924925,0.000922272,0.000919759,0.000917281,0.000914805,0.000912346,0.000909886,0.000907176,0.000904127,0.000901077,0.000898269,0.000895548,0.000892844,0.000890443,0.000888043,0.000885704,0.000883469,0.000881234,0.000878809,0.000876295,0.000873781,0.000870849,0.000867916,0.000865804,0.000865512,0.00086522,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865111,0.000865235,0.000866112,0.000866988,0.000868942,0.000872176,0.00087541,0.000878554,0.000881671,0.00088479,0.000887937,0.000891084,0.000894304,0.000897633,0.000900962,0.000904315,0.000907677,0.000911041,0.000914437,0.000917833,0.000921295,0.000924881,0.000928468,0.000933021,0.000938074,0.000943127,0.000949195,0.000955291,0.000961418,0.00096762,0.000973822,0.000979886,0.000985861,0.000991836,0.000998213,0.00100463,0.00101106,0.00101759,0.00102411,0.00103051,0.00103679,0.00104308,0.00104961,0.00105617,0.00106283,0.00106987,0.00107691};

	int which = floor(ms/0.001)-1;
	return list[which];
}

double boundBASEzp(double mzp){ //Its on Ut not Ut^2
	std::vector<double > list ={0.00548912,0.00550815,0.00552842,0.00554984,0.00557234,0.00559583,0.00562025,0.00564551,0.00567154,0.00569826,0.00572559,0.00575345,0.00578178,0.00581048,0.00583949,0.00586873,0.00589811,0.00592757,0.00595702,0.00598549,0.00601339,0.00604118,0.00606887,0.00609648,0.00612403,0.00615153,0.00617899,0.00620642,0.00623385,0.00626149,0.00628918,0.00631688,0.00634458,0.0063723,0.00640003,0.00642777,0.00645552,0.00648328,0.00651106,0.00653884,0.00656663,0.00659444,0.00662225,0.00665008,0.00667791,0.00670576,0.00673362,0.00676149,0.00678937,0.00681726,0.00684516,0.00687309,0.00690104,0.006929,0.00695697,0.00698494,0.00701292,0.00704091,0.0070689,0.00709689,0.00712488,0.00715287,0.00718086,0.00720884,0.00723678,0.00726473,0.00729267,0.0073206,0.00734854,0.00737647,0.00740439,0.00743232,0.00746024,0.00748816,0.00751607,0.00754398,0.0075719,0.0075998,0.00762771,0.00765562,0.00768352,0.00771142,0.00773932,0.00776722,0.00779511,0.00782301,0.0078509,0.00787879,0.00790668,0.00793457,0.00796246,0.00799034,0.00801823,0.00804612,0.008074,0.00810189,0.00812977,0.00815766,0.00818554,0.00821343,0.00824131,0.00826919,0.00829708,0.00832496,0.00835284,0.00838073,0.00840861,0.00843646,0.00846427,0.00849208,0.00851989,0.00854771,0.00857554,0.00860338,0.00863123,0.00865909,0.00868696,0.00871486,0.00874277,0.0087707,0.00879866,0.00882663,0.00885464,0.00888267,0.00891081,0.00893913,0.00896747,0.00899584,0.00902424,0.00905266,0.00908109,0.00910955,0.00913802,0.0091665,0.00919499,0.00922348,0.00925198,0.00928049,0.00930899,0.00933749,0.00936598,0.00939447,0.00942295,0.00945126,0.00947952,0.00950778,0.00953602,0.00956424,0.00959246,0.00962066,0.00964885,0.00967703,0.00970521,0.00973337,0.00976152,0.00978966,0.0098178,0.00984593,0.00987405,0.00990216,0.00993027,0.00995838,0.00998647,0.0100145,0.0100426,0.0100706,0.0100987,0.0101267,0.0101548,0.0101828,0.0102108,0.0102389,0.0102669,0.010295,0.0103231,0.0103511,0.0103792,0.0104073,0.0104354,0.0104635,0.0104917,0.0105198,0.010548,0.0105761,0.0106043,0.0106328,0.0106613,0.0106897,0.0107182,0.0107467,0.0107753,0.0108038,0.0108323,0.0108609,0.0108894,0.010918,0.0109465,0.0109751,0.0110036,0.0110322,0.0110607,0.0110892,0.0111178,0.0111463,0.0111748,0.0112033,0.0112317,0.0112602,0.0112884,0.0113165,0.0113445,0.0113725,0.0114005,0.0114285,0.0114564,0.0114844,0.0115124,0.0115403,0.0115683,0.0115962,0.0116241,0.0116521,0.01168,0.011708,0.011736,0.0117639,0.0117919,0.0118199,0.0118479,0.011876,0.011904,0.0119321,0.0119602,0.0119884,0.0120169,0.0120455,0.0120741,0.0121027,0.0121314,0.0121601,0.0121888,0.0122175,0.0122462,0.012275,0.0123038,0.0123326,0.0123614,0.0123902,0.012419,0.0124478,0.0124767,0.0125055,0.0125344,0.0125632,0.0125921,0.0126209,0.0126498,0.0126787,0.0127075,0.0127364,0.0127652,0.0127939,0.0128224,0.012851,0.0128795,0.012908,0.0129365,0.0129651,0.0129936,0.0130221,0.0130505,0.013079,0.0131075,0.013136,0.0131645,0.0131929,0.0132214,0.0132499,0.0132783,0.0133068,0.0133353,0.0133637,0.0133922,0.0134206,0.0134491,0.0134776,0.0135061,0.0135345,0.013563,0.0135915,0.01362,0.0136486,0.0136772,0.0137059,0.0137346,0.0137632,0.0137919,0.0138206,0.0138493,0.013878,0.0139067,0.0139353,0.013964,0.0139927,0.0140214,0.0140501,0.0140788,0.0141075,0.0141362,0.0141649,0.0141936,0.0142223,0.014251,0.0142797,0.0143084,0.0143371,0.0143658,0.0143945,0.0144231,0.0144518,0.0144805,0.0145091,0.0145378,0.0145664,0.0145948,0.0146232,0.0146517,0.0146801,0.0147085,0.0147369,0.0147654,0.0147938,0.0148222,0.0148506,0.014879,0.0149074,0.0149358,0.0149642,0.0149926,0.015021,0.0150494,0.0150778,0.0151063,0.0151347,0.0151631,0.0151915,0.01522,0.0152484,0.0152769,0.0153053,0.0153338,0.0153623,0.0153908,0.0154193,0.0154478,0.0154763,0.0155048,0.0155334,0.015562,0.0155908,0.0156197,0.0156485,0.0156774,0.0157063,0.0157352,0.0157641,0.015793,0.0158219,0.0158508,0.0158798,0.0159087,0.0159377,0.0159667,0.0159956,0.0160246,0.0160536,0.0160826,0.0161116,0.0161406,0.0161697,0.0161987,0.0162277,0.0162567,0.0162858,0.0163148,0.0163438,0.0163729,0.0164019,0.0164309,0.01646,0.016489,0.016518,0.0165471,0.0165761,0.0166051,0.0166342,0.0166631,0.016692,0.0167208,0.0167497,0.0167785,0.0168074,0.0168362,0.0168651,0.0168939,0.0169227,0.0169515,0.0169804,0.0170092,0.017038,0.0170668,0.0170956,0.0171244,0.0171532,0.017182,0.0172108,0.0172396,0.0172684,0.0172972,0.017326,0.0173548,0.0173836,0.0174123,0.0174411,0.0174699,0.0174987,0.0175274,0.0175562,0.017585,0.0176138,0.0176425,0.0176713,0.0177001,0.0177288,0.0177576,0.0177863,0.0178151,0.0178439,0.0178726,0.0179014,0.0179301,0.0179588,0.0179876,0.0180163,0.0180451,0.0180738,0.0181026,0.0181313,0.0181601,0.0181888,0.0182176,0.0182463,0.0182751,0.0183038,0.0183326,0.0183613,0.0183901,0.0184189,0.0184476,0.0184764,0.0185052,0.0185339,0.0185627,0.0185915,0.0186203,0.0186491,0.0186779,0.0187067,0.0187355,0.0187643,0.0187931,0.0188219,0.0188507,0.0188795,0.0189084,0.0189372,0.018966,0.0189949,0.0190237,0.0190526,0.0190814,0.0191103,0.0191393,0.0191683,0.0191973,0.0192263,0.0192553,0.0192843,0.0193133,0.0193424,0.0193714,0.0194005,0.0194295,0.0194585,0.0194876,0.0195167,0.0195457,0.0195748,0.0196039,0.0196329,0.019662,0.0196911,0.0197202,0.0197493,0.0197784,0.0198075,0.0198365,0.0198656,0.0198947,0.0199238,0.0199529,0.0199821,0.0200112,0.0200403,0.0200694,0.0200985,0.0201276,0.0201567,0.0201858,0.0202149,0.020244,0.0202731,0.0203022,0.0203313,0.0203604,0.0203896,0.0204187,0.0204478,0.0204769,0.020506,0.020535,0.0205639,0.0205929,0.0206218,0.0206508,0.0206797,0.0207086,0.0207376,0.0207665,0.0207955,0.0208244,0.0208533,0.0208823,0.0209112,0.0209402,0.0209691,0.020998,0.021027,0.0210559,0.0210848,0.0211138,0.0211427,0.0211717,0.0212006,0.0212296,0.0212585,0.0212874,0.0213164,0.0213454,0.0213743,0.0214033,0.0214322,0.0214612,0.0214901,0.0215191,0.0215481,0.0215771,0.021606,0.021635,0.021664,0.021693,0.021722,0.021751,0.02178,0.021809,0.021838,0.021867,0.021896,0.021925,0.0219541,0.0219831,0.0220121,0.0220413,0.0220705,0.0220998,0.022129,0.0221583,0.0221876,0.0222168,0.0222461,0.0222754,0.0223046,0.0223339,0.0223632,0.0223925,0.0224218,0.0224511,0.0224804,0.0225097,0.022539,0.0225683,0.0225977,0.022627,0.0226563,0.0226856,0.0227149,0.0227443,0.0227736,0.0228029,0.0228322,0.0228616,0.0228909,0.0229202,0.0229495,0.0229789,0.0230082,0.0230375,0.0230668,0.0230962,0.0231255,0.0231548,0.0231841,0.0232134,0.0232427,0.0232721,0.0233014,0.0233307,0.02336,0.0233893,0.0234186,0.0234479,0.0234771,0.0235064,0.0235357,0.023565,0.0235943,0.0236235,0.0236528,0.0236818,0.0237096,0.0237374,0.0237651,0.0237929,0.0238207,0.0238485,0.0238763,0.0239041,0.0239319,0.0239597,0.0239876,0.0240154,0.0240433,0.0240712,0.0240991,0.024127,0.024155,0.024183,0.024211,0.0242391,0.0242672,0.0242953,0.0243235,0.0243518,0.02438,0.0244083,0.0244367,0.0244651,0.0244936,0.0245222,0.0245507,0.0245794,0.0246081,0.0246369,0.0246658,0.0246947,0.0247237,0.0247528,0.0247819,0.0248112,0.0248405,0.0248699,0.0248994,0.024929,0.0249586,0.0249884,0.0250183,0.0250482,0.0250783,0.0251085,0.0251387,0.0251691,0.0251996,0.0252302,0.0252609,0.0252918,0.0253227,0.0253538,0.025385,0.0254163,0.0254482,0.025485,0.025522,0.0255591,0.0255963,0.0256337,0.0256711,0.0257087,0.0257464,0.0257841,0.0258219,0.0258599,0.0258978,0.0259359,0.025974,0.0260122,0.0260505,0.0260887,0.0261271,0.0261654,0.0262038,0.0262422,0.0262806,0.0263191,0.0263575,0.026396,0.0264344,0.0264728,0.0265112,0.0265496,0.026588,0.0266263,0.0266646,0.0267028,0.026741,0.0267791,0.0268172,0.0268552,0.0268931,0.026931,0.0269687,0.0270064,0.0270439,0.0270814,0.0271188,0.027156,0.0271931,0.0272301,0.027267,0.0273037,0.0273402,0.0273767,0.0274129,0.0274491,0.027485,0.0275208,0.0275564,0.0275918,0.027627,0.027662,0.0276968,0.0277314,0.0277658,0.0278,0.027834,0.0278602,0.0278858,0.0279112,0.0279363,0.0279612,0.0279858,0.0280102,0.0280344,0.0280583,0.028082,0.0281055,0.0281288,0.0281518,0.0281747,0.0281973,0.0282198,0.028242,0.0282641,0.028286,0.0283077,0.0283292,0.0283505,0.0283717,0.0283927,0.0284135,0.0284342,0.0284547,0.0284751,0.0284953,0.0285154,0.0285354,0.0285552,0.0285749,0.0285945,0.0286139,0.0286332,0.0286525,0.0286716,0.0286906,0.0287095,0.0287283,0.028747,0.0287656,0.0287842,0.0288027,0.0288211,0.0288394,0.0288576,0.0288758,0.028894,0.0289121,0.0289301,0.0289481,0.0289661,0.028984,0.0290019,0.0290197,0.0290375,0.0290553,0.0290731,0.0290909,0.0291087,0.0291265,0.0291442,0.029162,0.0291798,0.029197,0.0291966,0.0291962,0.0291958,0.0291953,0.0291948,0.0291943,0.0291938,0.0291933,0.0291928,0.0291922,0.0291916,0.029191,0.0291904,0.0291897,0.029189,0.0291884,0.0291876,0.0291869,0.0291862,0.0291854,0.0291846,0.0291838,0.029183,0.0291822,0.0291813,0.0291805,0.0291796,0.0291787,0.0291777,0.0291768,0.0291758,0.0291749,0.0291739,0.0291729,0.0291718,0.0291708,0.0291697,0.0291686,0.0291675,0.0291664,0.0291653,0.0291641,0.029163,0.0291618,0.0291606,0.0291594,0.0291581,0.0291569,0.0291556,0.0291544,0.0291531,0.0291517,0.0291504,0.0291491,0.0291477,0.0291464,0.029145,0.0291436,0.0291421,0.0291407,0.0291393,0.0291378,0.0291363,0.0291348,0.0291333,0.0291318,0.0291303,0.0291287,0.0291272,0.0291256};

	int which = floor((mzp-0.1)/0.001)-1;
	return list[which];
}

double boundPS191u(double ms){ //Its on Ut not Ut^2
	std::vector<double > list ={1,1,1,1,1,1,1,1,1,0.00882,0.00722945,0.00641711,0.00585193,0.00528676,0.00475623,0.00433964,0.00392306,0.00350648,0.00328187,0.00313554,0.0029892,0.00284287,0.00269654,0.0025502,0.00240387,0.00226016,0.00216438,0.0020686,0.00197281,0.00204033,0.00269336,0.00334638,0.00375489,0.00365421,0.00355353,0.00345285,0.00335217,0.00325149,0.00315081,0.00305013,0.00294944,0.00284876,0.00274808,0.00263944,0.00252981,0.00242018,0.00231054,0.00220091,0.00209127,0.00200069,0.00195115,0.00190161,0.00185206,0.00180252,0.00175298,0.00170343,0.00165389,0.00160435,0.00157005,0.0015396,0.00150916,0.00147871,0.00144827,0.00141782,0.00138738,0.00135693,0.00132649,0.00129604,0.0012656,0.00123515,0.00120471,0.00117426,0.00114381,0.00111337,0.00108292,0.00105248,0.00102203,0.000991589,0.000961143,0.000939967,0.000924332,0.000908698,0.000893063,0.000877429,0.000861794,0.00084616,0.000830525,0.00081489,0.000799256,0.000783621,0.000767987,0.000752352,0.000736717,0.000721083,0.000705448,0.000689814,0.000674179,0.000658545,0.00064291,0.000627275,0.000619057,0.00061094,0.000602823,0.000594707,0.00058659,0.000578473,0.000570357,0.00056224,0.000554123,0.000546007,0.00053789,0.000529773,0.000521657,0.00051354,0.000505423,0.000497307,0.00048919,0.000481073,0.000472957,0.00046484,0.000456723,0.000448606,0.00044049,0.000432373,0.000424256,0.00041614,0.000408023,0.000399906,0.00039179,0.000384733,0.000380953,0.000377173,0.000373392,0.000369612,0.000365832,0.000362052,0.000358271,0.000354491,0.000350711,0.000346931,0.00034315,0.00033937,0.00033559,0.000331809,0.000328029,0.000324249,0.000320469,0.000316688,0.000312908,0.000309128,0.000305347,0.000301567,0.000297787,0.000294007,0.000290226,0.000286446,0.000282666,0.000278885,0.000275105,0.000271325,0.000267545,0.000263764,0.000259984,0.000256204,0.000252423,0.000248643,0.000244863,0.000241083,0.000237302,0.000233522,0.000229742,0.000225961,0.000223771,0.000221964,0.000220158,0.000218351,0.000216545,0.000214738,0.000212932,0.000211126,0.000209319,0.000207513,0.000205706,0.0002039,0.000202094,0.000200287,0.000198481,0.000196674,0.000194868,0.000193061,0.000191255,0.000189449,0.000187642,0.000185836,0.000184029,0.000182223,0.000180416,0.00017861,0.000176804,0.000174997,0.000173191,0.000171384,0.000169578,0.000167771,0.000165965,0.000164159,0.000162352,0.000160546,0.000158739,0.000156946,0.0001556,0.000154254,0.000152908,0.000151562,0.000150216,0.00014887,0.000147524,0.000146178,0.000144832,0.000143923,0.000143246,0.00014257,0.000141893,0.000141217,0.00014054,0.000139863,0.000139187,0.00013851,0.000137834,0.000137157,0.000136481,0.000135804,0.000135127,0.000134451,0.000133774,0.000133098,0.000132421,0.000131745,0.000131068,0.000130391,0.000129715,0.000129038,0.000128362,0.000127685,0.000127009,0.000126332,0.000125655,0.000124979,0.000124302,0.000123626,0.000122949,0.000122273,0.000121596,0.000120919,0.000120243,0.000119566,0.00011889,0.000118213,0.000117537,0.00011686,0.000116183,0.000115507,0.00011483,0.000114154,0.000113477,0.000112801,0.000112124,0.000111447,0.000110771,0.000110094,0.000109418,0.000108741,0.000108065,0.000107388,0.000106711,0.000106035,0.000105358,0.000104682,0.000104005,0.000103329,0.000102652,0.000101976,0.000101299,0.000100622,0.0000999458,0.0000992692,0.0000985927,0.0000979161,0.0000972395,0.000096563,0.0000958864,0.0000952098,0.0000945332,0.0000938567,0.0000931801,0.0000925035,0.0000920298,0.0000915687,0.0000911076,0.0000906465};

	int which = floor(ms/0.001)-1;
	return list[which];
}

double boundNOMADt(double ms){ //Its on Ut not Ut^2
	std::vector<double > list ={1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.914568,0.760125,0.605681,0.510544,0.440687,0.370831,0.300974,0.251624,0.226438,0.201252,0.176065,0.151018,0.138629,0.126241,0.113852,0.101463,0.0890745,0.0766858,0.0713189,0.0663688,0.0614187,0.0564686,0.0515185,0.0465685,0.0416184,0.0383366,0.0359126,0.0334886,0.0310645,0.0286405,0.0262165,0.0249374,0.0236651,0.0223928,0.0211204,0.0198481,0.0185758,0.0173035,0.0160312,0.0150469,0.0143591,0.0136712,0.0129833,0.0122954,0.0116076,0.0109197,0.0102318,0.00976155,0.00934561,0.00892966,0.00851372,0.00809777,0.00768183,0.00731645,0.00705786,0.00679928,0.0065407,0.00628211,0.00602353,0.00576494,0.00550636,0.00526739,0.00509722,0.00492706,0.0047569,0.00458674,0.00441658,0.00424642,0.00407626,0.0039061,0.00373593,0.00362437,0.00351883,0.00341328,0.00330774,0.00320219,0.00309665,0.0029911,0.00288556,0.00278001,0.00267446,0.00258364,0.00251724,0.00245084,0.00238444,0.00231804,0.00225164,0.00218524,0.00211884,0.00205244,0.00200014,0.00194995,0.00189976,0.00184957,0.00179938,0.00174919,0.001699,0.00164882,0.00161127,0.00157754,0.0015438,0.00151007,0.00147634,0.00144261,0.00140887,0.00137514,0.00134141,0.00130767,0.00127394,0.00124373,0.00121828,0.00119283,0.00116738,0.00114193,0.00111647,0.00109102,0.00106739,0.00104737,0.00102735,0.00100732,0.000987296,0.000967271,0.000947246,0.000980478,0.0010422,0.00110393,0.00116565,0.00122738,0.0012891,0.00134916,0.00140052,0.00145189,0.00150326,0.00155463,0.00160568,0.00165369,0.00170169,0.0017497,0.0017977,0.0018457,0.00189371,0.00194171,0.00198972,0.00203772,0.00208572,0.00213373,0.00215981,0.00218454,0.00220927,0.002234,0.00225873,0.00228346,0.00230819,0.00233292,0.00235765,0.00238239,0.00241037,0.00243913,0.00246789,0.00249665,0.00252541,0.00255417,0.00258293,0.00261473,0.00267198,0.00272923,0.00278648,0.00284373,0.00290098,0.00295823,0.00309311,0.00327555,0.003458,0.00364044,0.00438986,0.00557859,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};

	int which = floor(ms/0.001)-1;
	return list[which];
}
double boundBABARzp(double mzp){ //Its on Ut not Ut^2
	std::vector<double > list ={0.000807418,0.000876985,0.000946552,0.00100873,0.0010699,0.00113107,0.00119223,0.0012534,0.00131457,0.00133376,0.00123269,0.00113162,0.00103055,0.000929477,0.0009139,0.000975392,0.00103688,0.00109838,0.00108463,0.00102456,0.000964495,0.000904429,0.000844363,0.00130197,0.00144145,0.00130979,0.00117814,0.00104649,0.000914838,0.000783185,0.000651533,0.00073546,0.000821942,0.000891762,0.000903757,0.000915752,0.000927747,0.000939742,0.000951737,0.000963732,0.000975727,0.000981584,0.000880852,0.000835331,0.000852594,0.000869857,0.000887121,0.000904384,0.000921647,0.000636702,0.000694241,0.000751781,0.000809321,0.000828254,0.000800563,0.000772872,0.000745181,0.00071749,0.000728235,0.000741003,0.000753772,0.000750434,0.000691762,0.000656448,0.000677039,0.00069763,0.000718221,0.000738811,0.000759402,0.000779993,0.000800584,0.00081562,0.000819199,0.000822778,0.000826357,0.000829936,0.000833515,0.000837094,0.000840673,0.000813569,0.000782044,0.000750518,0.000718993,0.000687468,0.000655942,0.000624417,0.000592891,0.000561366,0.000529841,0.000523447,0.00053815,0.000552853,0.000567556,0.00058226,0.000619589,0.000665076,0.000710564,0.000756051,0.000801539,0.000847026,0.000830295,0.000756373,0.000682451,0.000608529,0.000593801,0.000623375,0.000652948,0.000682522,0.000712095,0.000741669,0.000771242,0.000800816,0.00083039,0.000859963,0.000889537,0.00091911,0.000948684,0.000978257,0.000933288,0.000883039,0.00083279,0.000782541,0.000732292,0.000682043,0.000631795,0.000581546,0.000533114,0.000558672,0.00058423,0.000609788,0.000635346,0.000660905,0.000686463,0.000712021,0.000737579,0.000763137,0.000788695,0.000803952,0.000783325,0.000762698,0.000742071,0.000721444,0.000700817,0.00068019,0.000659563,0.000638937,0.00061831,0.000597683,0.000577056,0.000556429,0.000535802,0.000515175,0.000494548,0.000473921,0.000453294,0.000432667,0.000426005,0.00042695,0.000427894,0.000428838,0.000429782,0.000430726,0.000431671,0.000432615,0.000433559,0.000434503,0.000435447,0.000436392,0.000437336,0.00043828,0.000439224,0.000440168,0.000441113,0.000442057,0.000443001,0.000443945,0.000444889,0.000445834,0.000446778,0.000447722,0.000448666,0.00044961,0.000451591,0.000454615,0.00045764,0.000460664,0.000463689,0.000466713,0.000469737,0.000472762,0.000475786,0.00047881,0.000481835,0.000484859,0.000487883,0.000490908,0.000493932,0.000496957,0.000499762,0.000500677,0.000501591,0.000502506,0.00050342,0.000504335,0.000505249,0.000506163,0.000507078,0.000507992,0.000508907,0.000509821,0.000510736,0.00051165,0.000512565,0.000513479,0.000514393,0.000515308,0.000516222,0.000517137,0.000518051,0.000518966,0.00051988,0.000520794,0.000521709,0.000522623,0.000523538,0.000524452,0.000525367,0.000526281,0.000527196,0.00052811,0.000529024,0.000529939,0.000530853,0.000531768,0.000532682,0.000526451,0.000517309,0.000508167,0.000499025,0.000489883,0.000480742,0.0004716,0.000465175,0.00046595,0.000466724,0.000467499,0.000468273,0.000469048,0.000469822,0.000470597,0.000471371,0.000472146,0.00047292,0.000473695,0.000474469,0.000475244,0.000476018,0.000476793,0.000477567,0.000478342,0.000479116,0.000479891,0.000480665,0.00048144,0.000482214,0.000482989,0.000483763,0.000484538,0.000485312,0.000486087,0.000486861,0.000487636,0.00048841,0.000489185,0.000489959,0.000490734,0.000491508,0.000492283,0.000493057,0.000493832,0.000494606,0.000495381,0.000496058,0.000496507,0.000496957,0.000497406,0.000497856,0.000498305,0.000498755,0.000499204,0.000499654,0.000500103,0.000500552,0.000501002,0.000501451,0.000501901,0.00050235,0.0005028,0.000503249,0.000503699,0.000504148,0.000504597,0.000505047,0.000505496,0.000505946,0.000506395,0.000506845,0.000507294,0.000507744,0.000508193,0.000508642,0.000509092,0.000509541,0.000509991,0.00051044,0.00051089,0.000511339,0.000511789,0.000512238,0.000512687,0.000513137,0.000513586,0.000514036,0.000514485,0.000514935,0.000515384,0.000515834,0.000516283,0.000516357,0.000516359,0.000516362,0.000516364,0.000516366,0.000516369,0.000516371,0.000516373,0.000516376,0.000516378,0.00051638,0.000516382,0.000516385,0.000516387,0.000516389,0.000516392,0.000516394,0.000516396,0.000516399,0.000516401,0.000516403,0.000516406,0.000516408,0.00051641,0.000516412,0.000516415,0.000516433,0.000516611,0.000516789,0.000516967,0.000517145,0.000517322,0.0005175,0.000517678,0.000517856,0.000518034,0.000518212,0.00051839,0.000518568,0.000518746,0.000518924,0.000519102,0.000519279,0.000519457,0.000519635,0.000519813,0.000519991,0.000520169,0.000520347,0.000520525,0.000520703,0.000520881,0.000521058,0.000521236,0.000521414,0.000521592,0.00052177,0.000521948,0.000522126,0.000522304,0.000522482,0.00052266,0.000522838,0.000523015,0.000523193,0.000523371,0.000523549,0.000523727,0.000523905,0.000524083,0.000524261,0.000524439,0.000524617,0.000524795,0.000525163,0.000525706,0.000526248,0.00052679,0.000527332,0.000527875,0.000528417,0.000528959,0.000529502,0.000530044,0.000530586,0.000531128,0.000531671,0.000532213,0.000532755,0.000533298,0.000534172,0.000535131,0.000536091,0.000537051,0.00053801,0.00053897,0.00053993,0.000540889,0.000541849,0.000542809,0.000543768,0.000544728,0.000545688,0.000546647,0.000547607,0.000548567,0.000549526,0.000550486,0.000551446,0.000552405,0.000553365,0.000554324,0.000555284,0.000556244,0.000557203,0.000558163,0.000559123,0.000560082,0.000561042,0.000562002,0.000562961,0.000563921,0.000564881,0.00056584,0.0005668,0.00056776,0.000568719,0.000569679,0.000570639,0.000571598,0.000572558,0.00057354,0.000574962,0.000576383,0.000577804,0.000579226,0.000580647,0.000582069,0.00058349,0.000584911,0.000586333,0.000587754,0.000589176,0.000590597,0.000592018,0.00059344,0.000594861,0.000596283,0.000597704,0.000599125,0.000600547,0.000601968,0.000603389,0.000604811,0.000606232,0.000607654,0.000609075,0.000610496,0.000611882,0.000613157,0.000614432,0.000615707,0.000616982,0.000618256,0.000619531,0.000620806,0.000622081,0.000623356,0.00062463,0.000625905,0.00062718,0.000628455,0.00062973,0.000631004,0.000632279,0.000633554,0.000634829,0.000636104,0.000637379,0.000638653,0.000639928,0.000641203,0.000642478,0.000643753,0.000645027,0.000646302,0.000647577,0.000648852,0.000650127,0.000651401,0.000652676,0.000653951,0.000655226,0.000656501,0.000657775,0.00065905,0.000660325,0.0006616,0.000662875,0.000664149,0.000665424,0.000666699,0.000667974,0.000669249,0.000670524,0.000671798,0.000673073,0.000674348,0.000675623,0.000676898,0.000678172,0.000679986,0.000682724,0.000685463,0.000688202,0.000690941,0.000693679,0.000696418,0.000699157,0.000701895,0.000704634,0.000707373,0.000710111,0.00071285,0.000715589,0.000718327,0.000721066,0.000723805,0.000726543,0.000729282,0.000732021,0.000734759,0.000737498,0.000740237,0.000742975,0.000745714,0.000748453,0.000751192,0.00075393,0.000756669,0.000759408,0.000762146,0.000764885,0.000767624,0.000770362,0.000773101,0.00077584,0.000778708,0.000783151,0.000787595,0.000792038,0.000796481,0.000800925,0.000805368,0.000809811,0.000814255,0.000818698,0.000823141,0.000827585,0.000832028,0.000836471,0.000840915,0.000845358,0.000849801,0.000854245,0.000858688,0.000863131,0.000867575,0.000872018,0.000876461,0.000880905,0.000885348,0.000889791,0.000894235,0.000898678,0.000904336,0.000910261,0.000916187,0.000922112,0.000928038,0.000933963,0.000939888,0.000945814,0.000951739,0.000957664,0.00096359,0.000969515,0.000975441,0.000981366,0.000987291,0.000993217,0.000999142,0.00100507,0.00101099,0.00101692,0.00102284,0.00102877,0.00103469,0.00104062,0.00104655,0.00105247,0.0010584,0.00106432,0.00107025,0.00107617,0.0010821,0.00108802,0.00109395,0.00109987,0.0011058,0.00111172,0.00111765,0.00112357,0.0011295,0.00113543,0.00114135,0.00114728,0.0011532,0.00115913,0.00116505,0.00117098,0.00117424,0.00139303,0.00161183,0.00183062,0.00204942,0.00226821,0.002487,0.0027058,0.00292459,0.00314338,0.00336218,0.00349166,0.00348378,0.0034759,0.00346802,0.00346014,0.00345226,0.00344438,0.0034365,0.00342862,0.00342074,0.00341286,0.00340498,0.0033971,0.00338922,0.00338134,0.00337346,0.00336558,0.0033577,0.00334982,0.00334194,0.00333406,0.00332618,0.0033183,0.00331042,0.00330254,0.00329466,0.00328678,0.0032789,0.00327102,0.00326314,0.00325526,0.00324738,0.0032395,0.00323162,0.00322374,0.00321586,0.00320798,0.0032001,0.00319222,0.00318434,0.00317646,0.00316858,0.0031607,0.00315282,0.0030735,0.00291514,0.00275677,0.00259841,0.00244005,0.00228168,0.00212332,0.00196495,0.00180659,0.00164822,0.00148986,0.0013315,0.00117313,0.00101477,0.000777426,0.000774761,0.000772096,0.000769431,0.000766766,0.000764101,0.000761436,0.000758771,0.000756106,0.00075344,0.000750775,0.00074811,0.000745445,0.00074278,0.000740115,0.00073745,0.000734785,0.00073212,0.000729455,0.000726789,0.000724124,0.000721459,0.000718794,0.000716129,0.000713464,0.000710799,0.000708134,0.000706497,0.000705449,0.000704402,0.000703354,0.000702306,0.000701258,0.000700211,0.000699163,0.000698115,0.000697068,0.00069602,0.000694972,0.000693925,0.000692877,0.000691829,0.000690782,0.000689734,0.000688686,0.000687639,0.000686591,0.000685543,0.000684495,0.000683448,0.0006824,0.000681352,0.000680305,0.000679257,0.000678209,0.000677162,0.000676114,0.000675066,0.000674019,0.000672971,0.000671923,0.000670876,0.000669828,0.00066878,0.000667732,0.000666685,0.000665637,0.000664589,0.000663542,0.000663023,0.000662736,0.000662449,0.000662161,0.000661874,0.000661587,0.000661299,0.000661012,0.000660725,0.000660437,0.00066015,0.000659863,0.000659575,0.000659288,0.000659001,0.000658713,0.000658426,0.000658139,0.000657852,0.000657564,0.000657277,0.00065699,0.000656702,0.000656415,0.000656128,0.00065584,0.000655553,0.000655266,0.000654978,0.000654691,0.000654404,0.000654116,0.000653829,0.000653542,0.000653254,0.000652967,0.000658977,0.000728838,0.000798699,0.000868559,0.00093842,0.00100828,0.00107814,0.001148,0.00121786,0.00128772,0.00135759,0.00142745,0.00149731,0.00156717,0.00163703,0.00170689,0.00177675,0.00184661,0.00191647,0.00198633,0.00205619,0.00212605,0.00219592,0.00226578,0.00233564,0.0024055,0.00247536,0.00254522,0.00261508,0.00268494,0.0027548,0.00282466,0.00289452,0.00296438,0.00303424,0.00310411,0.00317397,0.00273602,0.000757371,0.000726066,0.000727578,0.00072909,0.000730603,0.000732115,0.000733628,0.00073514,0.000736652,0.000738165,0.000739677,0.00074119,0.000742702,0.000744214,0.000745727,0.000747239,0.000748751,0.000750264,0.000751776,0.000753289,0.000754801,0.000756313,0.000757826,0.000759338,0.0007969,0.000913531,0.00103016,0.00114679,0.00126342,0.00138005,0.00149669,0.00161332,0.00172995,0.00184658,0.00196321,0.00207984,0.00219647,0.0023131,0.00242973,0.00254636};

	int which = floor((mzp-0.1)/0.001)-1;
	return list[which];
}




